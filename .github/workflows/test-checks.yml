# Description: This workflow adds a check on PR.

name: POC / Test checks

on: pull_request

permissions:
  checks: write

jobs:
  setup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Amplify UI
        uses: actions/checkout@v3
        with:
          persist-credentials: false
      - name: Setup Node.js 16
        uses: actions/setup-node@v3
        with:
          node-version: 16
        env:
          SEGMENT_DOWNLOAD_TIMEOUT_MINS: 2
      - name: Add checks on PR
        id: create-check
        uses: ./.github/actions/add-check
        with:
          name: 'POC check'
          head-sha: ${{ github.event.pull_request.head.sha }}
          status: 'in_progress'
      - name: log
        run: echo "${{ steps.create-check.outputs.check-id }}"
        shell: bash
      - name: Sleep 10 seconds
        run: sleep 10s
        shell: bash
      - name: Update check
        uses: ./.github/actions/update-check
        with:
          check-id: ${{ steps.create-check.outputs.check-id }}
          status: 'completed'
          conclusion: 'success'
